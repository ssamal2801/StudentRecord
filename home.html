<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We"
      crossorigin="anonymous"
    />

    <title>System Testing</title>
    <style>
      #navbarText {
        padding: 10px;
        display: flex;
        flex-direction: column;
      }
      .navClass {
        background-color: rgb(196, 202, 204);
        margin-left: auto;
        margin-right: auto;
        width: 100%;
      }
      td {
        padding: 10px;
      }
      table {
        margin-left: auto;
        margin-right: auto;
      }
    </style>
    <script>
      let zipTest = /^(\d{5}(-\d{4})?|\d[A-Z]\d ?[A-Z]\d[A-Z])$/;
      let mobTest = /^\(?\d{3}\)?[-]?\d{3}[\s.-]\d{4}$/;
      let userRecord = JSON.parse(localStorage.getItem("user")) || [];
      let eachRecord = {};
      function formvalidation() {
        let isEmpty = false;
        localStorage.setItem("sample", "sample");
        //check if all any field is empty
        if (document.getElementById("firstname").value.length == 0) {
          alert("First name can't be empty");
          isEmpty = true;
        }
        if (document.getElementById("lastname").value.length == 0) {
          alert("Last name can't be empty");
          isEmpty = true;
        }
        if (document.getElementById("addr").value.length == 0) {
          alert("address can't be empty");
          isEmpty = true;
        }
        if (document.getElementById("email").value.length == 0) {
          alert("email address can't be empty");
          isEmpty = true;
        }
        if (document.getElementById("notes").value.length == 0) {
          alert("notes can't be empty");
          isEmpty = true;
        }
        if (document.getElementById("city").value.length == 0) {
          alert("city can't be empty");
          isEmpty = true;
        }
        if (document.getElementById("province").value.length == 0) {
          alert("province can't be empty");
          isEmpty = true;
        }
        //check zip code
        if (!zipTest.test(document.getElementById("zip").value)) {
          alert("Please enter a valid zip code");
          isEmpty = true;
        }
        //check phone number
        if (!mobTest.test(document.getElementById("mob").value)) {
          alert("Please enter a valid phone number");
          isEmpty = true;
        }
        //if validation passes, save data
        if (typeof Storage !== "undefined") {
          if (!isEmpty) {
            eachRecord = {
              firstname: document.getElementById("firstname").value,
              lastname: document.getElementById("lastname").value,
              address: document.getElementById("addr").value,
              city: document.getElementById("city").value,
              province: document.getElementById("province").value,
              zip: document.getElementById("zip").value,
              mob: document.getElementById("mob").value,
              email: document.getElementById("email").value,
              notes: document.getElementById("notes").value,
            };
            userRecord.push(eachRecord);
            localStorage.setItem("user", JSON.stringify(userRecord));
            window.location.href = "/home.html";
            alert("data saved");
          } else {
            alert("Please fill all details");
          }
        } else {
          alert("Your browser doesn't support local strage");
        }
      }
    </script>
  </head>
  <!------BODY------>
  <body>
    <!------NAVIGATION------>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="navClass" id="navbarText">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" href="">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="/search_all.html"
              >See All Record</a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="/search_latest.html"
              >See Last Record</a
            >
          </li>
        </ul>
      </div>
    </nav>
    <!------FORM------>
    <form class="my-form" method="POST">
      <div
        class="card text-white bg-secondary mb-3"
        style="max-width: 50%; margin-left: auto; margin-right: auto"
      >
        <div class="card-header">
          <h5 style="text-align: center">Registration Form</h5>
        </div>
        <div class="card-body">
          <table>
            <tr>
              <td>First name</td>
              <td>
                <input class="form-control" type="text" id="firstname" />
              </td>
            </tr>
            <tr>
              <td>Last name</td>
              <td>
                <input class="form-control" type="text" id="lastname" />
              </td>
            </tr>
            <tr>
              <td>Address</td>
              <td><input class="form-control" type="text" id="addr" /></td>
            </tr>
            <tr>
              <td>City</td>
              <td>
                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <label class="input-group-text" for="city">Options</label>
                  </div>
                  <select class="custom-select" id="city" name="city">
                    <option value="" disabled selected>
                      Please select a city
                    </option>
                    <option value="Mississauga">Mississauga</option>
                    <option value="Winnipeg">Winnipeg</option>
                    <option value="Quebec City">Quebec City</option>
                    <option value="Hamilton">Hamilton</option>
                    <option value="Brampton">Brampton</option>
                    <option value="Surrey">Surrey</option>
                    <option value="Toronto">Toronto</option>
                    <option value="Montréal">Montréal</option>
                    <option value="Vancouver">Vancouver</option>
                    <option value="Calgary">Calgary</option>
                    <option value="Edmonton">Edmonton</option>
                    <option value="Ottawa">Ottawa</option>
                  </select>
                </div>
              </td>
            </tr>
            <tr>
              <td>Province</td>
              <td>
                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <label class="input-group-text" for="province"
                      >Options</label
                    >
                  </div>
                  <select class="custom-select" id="province" name="province">
                    <option value="" disabled selected>
                      Please select a province
                    </option>
                    <option value="Alberta">Alberta</option>
                    <option value="British Columbia">British Columbia</option>
                    <option value="Manitoba">Manitoba</option>
                    <option value="New Brunswick">New Brunswick</option>
                    <option value="Newfoundland and Labrador">
                      Newfoundland and Labrador
                    </option>
                    <option value="Ontario">Ontario</option>
                    <option value="Prince Edward Island">
                      Prince Edward Island
                    </option>
                    <option value="Quebec">Quebec</option>
                    <option value="Saskatchewan">Saskatchewan</option>
                    <option value="Yukon">Yukon</option>
                    <option value="Northwest Territories">
                      Northwest Territories
                    </option>
                    <option value="Nova Scotia">Nova Scotia</option>
                    <option value="Nunavut">Nunavut</option>
                  </select>
                </div>
              </td>
            </tr>
            <tr>
              <td>Zip Code</td>
              <td>
                <input class="form-control" id="zip" type="text" />
              </td>
            </tr>
            <tr>
              <td>Primary Mobile</td>
              <td>
                <input
                  class="form-control"
                  id="mob"
                  type="text"
                  name="mobile"
                />
              </td>
            </tr>
            <tr>
              <td>Primary Email</td>
              <td><input class="form-control" type="text" id="email" /></td>
            </tr>
            <tr>
              <td>Notes</td>
              <td>
                <textarea
                  class="form-control"
                  type="textArea"
                  id="notes"
                  rows="5"
                ></textarea>
              </td>
            </tr>
          </table>
        </div>
        <button
          type="button"
          class="btn btn-primary"
          onclick="formvalidation()"
        >
          Save
        </button>
      </div>
    </form>
    <!------FORM END------>
  </body>
</html>
